<svg id="mermaid-diagram-1760439361432-tvmzmtkls" width="1051.918701171875" xmlns="http://www.w3.org/2000/svg" class="flowchart" height="2334" viewBox="0 0 1051.918701171875 2334" role="graphics-document document" aria-roledescription="flowchart-v2"><style>#mermaid-diagram-1760439361432-tvmzmtkls{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-diagram-1760439361432-tvmzmtkls .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-diagram-1760439361432-tvmzmtkls .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-diagram-1760439361432-tvmzmtkls .error-icon{fill:#552222;}#mermaid-diagram-1760439361432-tvmzmtkls .error-text{fill:#552222;stroke:#552222;}#mermaid-diagram-1760439361432-tvmzmtkls .edge-thickness-normal{stroke-width:1px;}#mermaid-diagram-1760439361432-tvmzmtkls .edge-thickness-thick{stroke-width:3.5px;}#mermaid-diagram-1760439361432-tvmzmtkls .edge-pattern-solid{stroke-dasharray:0;}#mermaid-diagram-1760439361432-tvmzmtkls .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-diagram-1760439361432-tvmzmtkls .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-diagram-1760439361432-tvmzmtkls .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-diagram-1760439361432-tvmzmtkls .marker{fill:#000000;stroke:#000000;}#mermaid-diagram-1760439361432-tvmzmtkls .marker.cross{stroke:#000000;}#mermaid-diagram-1760439361432-tvmzmtkls svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-diagram-1760439361432-tvmzmtkls p{margin:0;}#mermaid-diagram-1760439361432-tvmzmtkls .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-diagram-1760439361432-tvmzmtkls .cluster-label text{fill:#333;}#mermaid-diagram-1760439361432-tvmzmtkls .cluster-label span{color:#333;}#mermaid-diagram-1760439361432-tvmzmtkls .cluster-label span p{background-color:transparent;}#mermaid-diagram-1760439361432-tvmzmtkls .label text,#mermaid-diagram-1760439361432-tvmzmtkls span{fill:#333;color:#333;}#mermaid-diagram-1760439361432-tvmzmtkls .node rect,#mermaid-diagram-1760439361432-tvmzmtkls .node circle,#mermaid-diagram-1760439361432-tvmzmtkls .node ellipse,#mermaid-diagram-1760439361432-tvmzmtkls .node polygon,#mermaid-diagram-1760439361432-tvmzmtkls .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-diagram-1760439361432-tvmzmtkls .rough-node .label text,#mermaid-diagram-1760439361432-tvmzmtkls .node .label text,#mermaid-diagram-1760439361432-tvmzmtkls .image-shape .label,#mermaid-diagram-1760439361432-tvmzmtkls .icon-shape .label{text-anchor:middle;}#mermaid-diagram-1760439361432-tvmzmtkls .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-diagram-1760439361432-tvmzmtkls .rough-node .label,#mermaid-diagram-1760439361432-tvmzmtkls .node .label,#mermaid-diagram-1760439361432-tvmzmtkls .image-shape .label,#mermaid-diagram-1760439361432-tvmzmtkls .icon-shape .label{text-align:center;}#mermaid-diagram-1760439361432-tvmzmtkls .node.clickable{cursor:pointer;}#mermaid-diagram-1760439361432-tvmzmtkls .root .anchor path{fill:#000000!important;stroke-width:0;stroke:#000000;}#mermaid-diagram-1760439361432-tvmzmtkls .arrowheadPath{fill:#333333;}#mermaid-diagram-1760439361432-tvmzmtkls .edgePath .path{stroke:#000000;stroke-width:2.0px;}#mermaid-diagram-1760439361432-tvmzmtkls .flowchart-link{stroke:#000000;fill:none;}#mermaid-diagram-1760439361432-tvmzmtkls .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-diagram-1760439361432-tvmzmtkls .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#mermaid-diagram-1760439361432-tvmzmtkls .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-diagram-1760439361432-tvmzmtkls .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaid-diagram-1760439361432-tvmzmtkls .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-diagram-1760439361432-tvmzmtkls .cluster text{fill:#333;}#mermaid-diagram-1760439361432-tvmzmtkls .cluster span{color:#333;}#mermaid-diagram-1760439361432-tvmzmtkls div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:#ffffff;border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-diagram-1760439361432-tvmzmtkls .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-diagram-1760439361432-tvmzmtkls rect.text{fill:none;stroke-width:0;}#mermaid-diagram-1760439361432-tvmzmtkls .icon-shape,#mermaid-diagram-1760439361432-tvmzmtkls .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-diagram-1760439361432-tvmzmtkls .icon-shape p,#mermaid-diagram-1760439361432-tvmzmtkls .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#mermaid-diagram-1760439361432-tvmzmtkls .icon-shape rect,#mermaid-diagram-1760439361432-tvmzmtkls .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-diagram-1760439361432-tvmzmtkls .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em;}#mermaid-diagram-1760439361432-tvmzmtkls .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert;}#mermaid-diagram-1760439361432-tvmzmtkls :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><marker id="mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker><marker id="mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></circle></marker><marker id="mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><marker id="mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path d="M388.838,59.948L376.251,64.456C363.665,68.965,338.492,77.983,325.905,93.158C313.319,108.333,313.319,129.667,313.319,153C313.319,176.333,313.319,201.667,313.319,219.833C313.319,238,313.319,249,313.319,254.5L313.319,260" id="L_Input_P_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M480.396,62L483.778,66.167C487.16,70.333,493.924,78.667,497.306,86.333C500.688,94,500.688,101,500.688,104.5L500.688,108" id="L_Input_X_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M528.125,46.51L568.956,53.259C609.788,60.007,691.45,73.503,732.281,90.918C773.113,108.333,773.113,129.667,773.113,153C773.113,176.333,773.113,201.667,773.113,219.833C773.113,238,773.113,249,773.113,254.5L773.113,260" id="L_Input_O_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M571.244,162.808L635.169,173.507C699.094,184.206,826.944,205.603,890.869,228.968C954.794,252.333,954.794,277.667,954.794,303C954.794,328.333,954.794,353.667,954.794,379C954.794,404.333,954.794,429.667,954.794,453C954.794,476.333,954.794,497.667,954.794,511.833C954.794,526,954.794,533,954.794,536.5L954.794,540" id="L_X_Q_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M500.688,190L500.688,196.167C500.688,202.333,500.688,214.667,500.688,226.333C500.688,238,500.688,249,500.688,254.5L500.688,260" id="L_X_K_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M430.131,163.861L372.4,174.384C314.669,184.907,199.206,205.954,141.475,221.977C83.744,238,83.744,249,83.744,254.5L83.744,260" id="L_X_V_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M479.029,342L475.604,348.167C472.18,354.333,465.331,366.667,469.212,378.588C473.094,390.508,487.707,402.017,495.014,407.771L502.321,413.525" id="L_K_KNN1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M374.944,318.816L414.028,328.846C453.111,338.877,531.279,358.939,566.332,374.594C601.385,390.25,593.324,401.499,589.293,407.124L585.262,412.749" id="L_P_KNN1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M820.56,342L828.063,348.167C835.565,354.333,850.57,366.667,820.888,381.932C791.207,397.198,716.838,415.395,679.654,424.494L642.47,433.593" id="L_O_KNN1_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M554.984,494L554.984,498.167C554.984,502.333,554.984,510.667,554.984,518.333C554.984,526,554.984,533,554.984,536.5L554.984,540" id="L_KNN1_KNeighbors_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M83.744,342L83.744,348.167C83.744,354.333,83.744,366.667,91.619,378.606C99.494,390.545,115.245,402.09,123.12,407.863L130.996,413.635" id="L_V_KNN2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M291.66,342L288.236,348.167C284.811,354.333,277.962,366.667,268.24,378.552C258.519,390.437,245.926,401.874,239.629,407.592L233.333,413.311" id="L_P_KNN2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M718.894,313.092L659.878,324.076C600.861,335.061,482.829,357.031,409.257,374.252C335.685,391.474,306.573,403.948,292.017,410.185L277.461,416.422" id="L_O_KNN2_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M187.428,494L187.428,498.167C187.428,502.333,187.428,510.667,187.428,518.333C187.428,526,187.428,533,187.428,536.5L187.428,540" id="L_KNN2_VNeighbors_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M496.154,622L486.852,628.167C477.55,634.333,458.945,646.667,449.643,658.333C440.341,670,440.341,681,440.341,686.5L440.341,692" id="L_KNeighbors_RelPos_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M613.815,622L623.117,628.167C632.419,634.333,651.024,646.667,660.326,658.333C669.628,670,669.628,681,669.628,686.5L669.628,692" id="L_KNeighbors_KNeighborsClean_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M440.341,774L440.341,780.167C440.341,786.333,440.341,798.667,440.341,810.333C440.341,822,440.341,833,440.341,838.5L440.341,844" id="L_RelPos_EncPos_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M954.794,622L954.794,628.167C954.794,634.333,954.794,646.667,954.794,658.333C954.794,670,954.794,681,954.794,686.5L954.794,692" id="L_Q_QExp_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M669.628,774L669.628,780.167C669.628,786.333,669.628,798.667,698.1,814.563C726.572,830.46,783.515,849.92,811.987,859.65L840.459,869.38" id="L_KNeighborsClean_Diff_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M954.794,774L954.794,780.167C954.794,786.333,954.794,798.667,948.473,812.486C942.152,826.305,929.51,841.611,923.189,849.263L916.868,856.916" id="L_QExp_Diff_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M845.62,914L835.023,920.167C824.426,926.333,803.232,938.667,792.635,948.333C782.038,958,782.038,965,782.038,968.5L782.038,972" id="L_Diff_QKDiff_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M782.038,1054L782.038,1058.167C782.038,1062.333,782.038,1070.667,787.171,1080.506C792.304,1090.345,802.571,1101.689,807.704,1107.362L812.838,1113.034" id="L_QKDiff_Combine_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M536.428,900.3L597.479,908.75C658.529,917.2,780.63,934.1,841.681,953.217C902.731,972.333,902.731,993.667,902.731,1015C902.731,1036.333,902.731,1057.667,897.149,1074.024C891.568,1090.381,880.404,1101.763,874.822,1107.454L869.24,1113.144" id="L_EncPos_Combine_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M839.956,1170L839.956,1178.167C839.956,1186.333,839.956,1202.667,839.956,1216.333C839.956,1230,839.956,1241,839.956,1246.5L839.956,1252" id="L_Combine_AttnInput_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M839.956,1334L839.956,1340.167C839.956,1346.333,839.956,1358.667,839.956,1370.333C839.956,1382,839.956,1393,839.956,1398.5L839.956,1404" id="L_AttnInput_AttnScores_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M839.956,1486L839.956,1492.167C839.956,1498.333,839.956,1510.667,839.956,1522.333C839.956,1534,839.956,1545,839.956,1550.5L839.956,1556" id="L_AttnScores_AttnWeights_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M187.428,622L187.428,628.167C187.428,634.333,187.428,646.667,187.428,665.5C187.428,684.333,187.428,709.667,187.428,735C187.428,760.333,187.428,785.667,187.428,811C187.428,836.333,187.428,861.667,187.428,885C187.428,908.333,187.428,929.667,190.232,945.904C193.035,962.142,198.642,973.285,201.446,978.856L204.249,984.427" id="L_VNeighbors_CombFeats_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M440.341,926L440.341,930.167C440.341,934.333,440.341,942.667,419.225,952.957C398.109,963.246,355.877,975.493,334.761,981.616L313.645,987.739" id="L_EncPos_CombFeats_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M219.634,1042L219.634,1048.167C219.634,1054.333,219.634,1066.667,219.634,1076.333C219.634,1086,219.634,1093,219.634,1096.5L219.634,1100" id="L_CombFeats_Combined_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M219.634,1182L219.634,1188.167C219.634,1194.333,219.634,1206.667,219.634,1218.333C219.634,1230,219.634,1241,219.634,1246.5L219.634,1252" id="L_Combined_Grouped_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M839.956,1638L839.956,1644.167C839.956,1650.333,839.956,1662.667,839.956,1674.333C839.956,1686,839.956,1697,839.956,1702.5L839.956,1708" id="L_AttnWeights_AttnExp_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M219.634,1334L219.634,1340.167C219.634,1346.333,219.634,1358.667,219.634,1377.5C219.634,1396.333,219.634,1421.667,219.634,1447C219.634,1472.333,219.634,1497.667,219.634,1523C219.634,1548.333,219.634,1573.667,219.634,1599C219.634,1624.333,219.634,1649.667,219.634,1675C219.634,1700.333,219.634,1725.667,219.634,1749C219.634,1772.333,219.634,1793.667,224.825,1808.108C230.015,1822.549,240.395,1830.098,245.586,1833.873L250.776,1837.647" id="L_Grouped_Multiply_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M839.956,1790L839.956,1794.167C839.956,1798.333,839.956,1806.667,765.854,1817.854C691.752,1829.042,543.549,1843.084,469.447,1850.105L395.345,1857.126" id="L_AttnExp_Multiply_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M291.138,1894L291.138,1898.167C291.138,1902.333,291.138,1910.667,291.138,1918.333C291.138,1926,291.138,1933,291.138,1936.5L291.138,1940" id="L_Multiply_Weighted_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M291.138,2022L291.138,2028.167C291.138,2034.333,291.138,2046.667,291.138,2058.333C291.138,2070,291.138,2081,291.138,2086.5L291.138,2092" id="L_Weighted_Aggregated_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path><path d="M291.138,2174L291.138,2180.167C291.138,2186.333,291.138,2198.667,291.138,2210.333C291.138,2222,291.138,2233,291.138,2238.5L291.138,2244" id="L_Aggregated_OutputFinal_0" class=" edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style="" marker-end="url(#mermaid-diagram-1760439361432-tvmzmtkls_flowchart-v2-pointEnd)"></path></g><g class="edgeLabels"><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(954.7937507629395, 379)"><g class="label" transform="translate(-29.34375, -12)"><foreignObject width="58.6875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>linear_q</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(500.68750381469727, 227)"><g class="label" transform="translate(-28.918750762939453, -12)"><foreignObject width="57.837501525878906" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>linear_k</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(83.7437515258789, 227)"><g class="label" transform="translate(-28.806249618530273, -12)"><foreignObject width="57.61249923706055" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>linear_v</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(440.3406295776367, 659)"><g class="label" transform="translate(-47.56875228881836, -12)"><foreignObject width="95.13750457763672" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>slice [:,:,0:3]</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(669.6281280517578, 659)"><g class="label" transform="translate(-43.375, -12)"><foreignObject width="86.75" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>slice [:,:,3:]</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(440.3406295776367, 811)"><g class="label" transform="translate(-78.0999984741211, -12)"><foreignObject width="156.1999969482422" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>position_encoder MLP</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(954.7937507629395, 659)"><g class="label" transform="translate(-47.76874923706055, -12)"><foreignObject width="95.5374984741211" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>unsqueeze(1)</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(839.9562530517578, 1371)"><g class="label" transform="translate(-51.056251525878906, -12)"><foreignObject width="102.11250305175781" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>attention_mlp</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(839.9562530517578, 1523)"><g class="label" transform="translate(-56.76874923706055, -12)"><foreignObject width="113.5374984741211" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>Softmax(dim=1)</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(219.6343765258789, 1219)"><g class="label" transform="translate(-107.9000015258789, -12)"><foreignObject width="215.8000030517578" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="edgeLabel "><p>view(N,K,Ngrp,out_dim/Ngrp)</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(839.9562530517578, 1675)"><g class="label" transform="translate(-47.76874923706055, -12)"><foreignObject width="95.5374984741211" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>unsqueeze(2)</p></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel"><g class="label" transform="translate(0, 0)"><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(291.13750076293945, 2059)"><g class="label" transform="translate(-41.900001525878906, -12)"><foreignObject width="83.80000305175781" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>sum(dim=1)</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(291.13750076293945, 2211)"><g class="label" transform="translate(-62.25625228881836, -12)"><foreignObject width="124.51250457763672" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel "><p>view(N, out_dim)</p></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default  " id="flowchart-Input-0" transform="translate(458.4812545776367, 35)"><rect class="basic label-container" style="fill:#f3f4f6 !important;stroke:#6b7280 !important;stroke-width:2px !important" x="-69.64374923706055" y="-27" width="139.2874984741211" height="54"></rect><g class="label" style="" transform="translate(-39.64374923706055, -12)"><rect></rect><foreignObject width="79.2874984741211" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Input (pxo)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-P-1" transform="translate(313.31875228881836, 303)"><rect class="basic label-container" style="fill:#e0f2fe !important;stroke:#2563eb !important;stroke-width:2px !important" x="-61.625" y="-39" width="123.25" height="78"></rect><g class="label" style="" transform="translate(-31.625, -24)"><rect></rect><foreignObject width="63.25" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>positions<br/>(N, 3)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-X-3" transform="translate(500.68750381469727, 151)"><rect class="basic label-container" style="fill:#e0f2fe !important;stroke:#2563eb !important;stroke-width:2px !important" x="-70.5562515258789" y="-39" width="141.1125030517578" height="78"></rect><g class="label" style="" transform="translate(-40.556251525878906, -24)"><rect></rect><foreignObject width="81.11250305175781" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>features<br/>(N, in_dim)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-O-5" transform="translate(773.1125030517578, 303)"><rect class="basic label-container" style="fill:#e0f2fe !important;stroke:#2563eb !important;stroke-width:2px !important" x="-54.21875" y="-39" width="108.4375" height="78"></rect><g class="label" style="" transform="translate(-24.21875, -24)"><rect></rect><foreignObject width="48.4375" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>offsets<br/>(B,)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-Q-7" transform="translate(954.7937507629395, 583)"><rect class="basic label-container" style="fill:#dbeafe !important;stroke:#3b82f6 !important;stroke-width:2px !important" x="-75.7437515258789" y="-39" width="151.4875030517578" height="78"></rect><g class="label" style="" transform="translate(-45.743751525878906, -24)"><rect></rect><foreignObject width="91.48750305175781" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>query<br/>(N, out_dim)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-K-9" transform="translate(500.68750381469727, 303)"><rect class="basic label-container" style="fill:#dbeafe !important;stroke:#3b82f6 !important;stroke-width:2px !important" x="-75.7437515258789" y="-39" width="151.4875030517578" height="78"></rect><g class="label" style="" transform="translate(-45.743751525878906, -24)"><rect></rect><foreignObject width="91.48750305175781" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>key<br/>(N, out_dim)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-V-11" transform="translate(83.7437515258789, 303)"><rect class="basic label-container" style="fill:#dbeafe !important;stroke:#3b82f6 !important;stroke-width:2px !important" x="-75.7437515258789" y="-39" width="151.4875030517578" height="78"></rect><g class="label" style="" transform="translate(-45.743751525878906, -24)"><rect></rect><foreignObject width="91.48750305175781" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>value<br/>(N, out_dim)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-KNN1-13" transform="translate(554.9843788146973, 455)"><rect class="basic label-container" style="fill:#fef3c7 !important;stroke:#d97706 !important;stroke-width:2px !important" x="-83.60000228881836" y="-39" width="167.20000457763672" height="78"></rect><g class="label" style="" transform="translate(-53.60000228881836, -24)"><rect></rect><foreignObject width="107.20000457763672" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>queryandgroup<br/>(use_xyz=True)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-KNeighbors-19" transform="translate(554.9843788146973, 583)"><rect class="basic label-container" style="fill:#e0e7ff !important;stroke:#6366f1 !important;stroke-width:2px !important" x="-98.90625" y="-39" width="197.8125" height="78"></rect><g class="label" style="" transform="translate(-68.90625, -24)"><rect></rect><foreignObject width="137.8125" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>key_neighbors<br/>(N, K, 3 + out_dim)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-KNN2-21" transform="translate(187.42812728881836, 455)"><rect class="basic label-container" style="fill:#fef3c7 !important;stroke:#d97706 !important;stroke-width:2px !important" x="-86.35625076293945" y="-39" width="172.7125015258789" height="78"></rect><g class="label" style="" transform="translate(-56.35625076293945, -24)"><rect></rect><foreignObject width="112.7125015258789" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>queryandgroup<br/>(use_xyz=False)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-VNeighbors-27" transform="translate(187.42812728881836, 583)"><rect class="basic label-container" style="fill:#e0e7ff !important;stroke:#6366f1 !important;stroke-width:2px !important" x="-87.91250228881836" y="-39" width="175.82500457763672" height="78"></rect><g class="label" style="" transform="translate(-57.91250228881836, -24)"><rect></rect><foreignObject width="115.82500457763672" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>value_neighbors<br/>(N, K, out_dim)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-RelPos-29" transform="translate(440.3406295776367, 735)"><rect class="basic label-container" style="fill:#e0e7ff !important;stroke:#6366f1 !important;stroke-width:2px !important" x="-93.59375" y="-39" width="187.1875" height="78"></rect><g class="label" style="" transform="translate(-63.59375, -24)"><rect></rect><foreignObject width="127.1875" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>relative_positions<br/>(N, K, 3)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-KNeighborsClean-31" transform="translate(669.6281280517578, 735)"><rect class="basic label-container" style="fill:#e0e7ff !important;stroke:#6366f1 !important;stroke-width:2px !important" x="-85.69375228881836" y="-39" width="171.38750457763672" height="78"></rect><g class="label" style="" transform="translate(-55.69375228881836, -24)"><rect></rect><foreignObject width="111.38750457763672" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>key_neighbors<br/>(N, K, out_dim)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-EncPos-33" transform="translate(440.3406295776367, 887)"><rect class="basic label-container" style="fill:#fce7f3 !important;stroke:#db2777 !important;stroke-width:2px !important" x="-96.0875015258789" y="-39" width="192.1750030517578" height="78"></rect><g class="label" style="" transform="translate(-66.0875015258789, -24)"><rect></rect><foreignObject width="132.1750030517578" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>encoded_positions<br/>(N, K, out_dim)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-QExp-35" transform="translate(954.7937507629395, 735)"><rect class="basic label-container" style="" x="-89.125" y="-39" width="178.25" height="78"></rect><g class="label" style="" transform="translate(-59.125, -24)"><rect></rect><foreignObject width="118.25" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>query_expanded<br/>(N, 1, out_dim)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-Diff-37" transform="translate(892.0187530517578, 887)"><rect class="basic label-container" style="" x="-47.77499961853027" y="-27" width="95.54999923706055" height="54"></rect><g class="label" style="" transform="translate(-17.774999618530273, -12)"><rect></rect><foreignObject width="35.54999923706055" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>K - Q</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-QKDiff-41" transform="translate(782.0375022888184, 1015)"><rect class="basic label-container" style="fill:#fed7aa !important;stroke:#ea580c !important;stroke-width:2px !important" x="-85.69375228881836" y="-39" width="171.38750457763672" height="78"></rect><g class="label" style="" transform="translate(-55.69375228881836, -24)"><rect></rect><foreignObject width="111.38750457763672" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>qk_diff<br/>(N, K, out_dim)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-Combine-43" transform="translate(839.9562530517578, 1143)"><rect class="basic label-container" style="" x="-110.8062515258789" y="-27" width="221.6125030517578" height="54"></rect><g class="label" style="" transform="translate(-80.8062515258789, -12)"><rect></rect><foreignObject width="161.6125030517578" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>qk_diff + encoded_pos</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-AttnInput-47" transform="translate(839.9562530517578, 1295)"><rect class="basic label-container" style="fill:#fed7aa !important;stroke:#ea580c !important;stroke-width:2px !important" x="-86.25" y="-39" width="172.5" height="78"></rect><g class="label" style="" transform="translate(-56.25, -24)"><rect></rect><foreignObject width="112.5" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>attention_input<br/>(N, K, out_dim)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-AttnScores-49" transform="translate(839.9562530517578, 1447)"><rect class="basic label-container" style="fill:#fef3c7 !important;stroke:#d97706 !important;stroke-width:2px !important" x="-106.57500457763672" y="-39" width="213.15000915527344" height="78"></rect><g class="label" style="" transform="translate(-76.57500457763672, -24)"><rect></rect><foreignObject width="153.15000915527344" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>attention_scores<br/>(N, K, out_dim/Ngrp)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-AttnWeights-51" transform="translate(839.9562530517578, 1599)"><rect class="basic label-container" style="fill:#dcfce7 !important;stroke:#16a34a !important;stroke-width:2px !important" x="-106.57500457763672" y="-39" width="213.15000915527344" height="78"></rect><g class="label" style="" transform="translate(-76.57500457763672, -24)"><rect></rect><foreignObject width="153.15000915527344" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>attention_weights<br/>(N, K, out_dim/Ngrp)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-CombFeats-53" transform="translate(219.6343765258789, 1015)"><rect class="basic label-container" style="" x="-90.16875076293945" y="-27" width="180.3375015258789" height="54"></rect><g class="label" style="" transform="translate(-60.16875076293945, -12)"><rect></rect><foreignObject width="120.3375015258789" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>V + encoded_pos</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-Combined-57" transform="translate(219.6343765258789, 1143)"><rect class="basic label-container" style="fill:#e0e7ff !important;stroke:#6366f1 !important;stroke-width:2px !important" x="-98.80000305175781" y="-39" width="197.60000610351562" height="78"></rect><g class="label" style="" transform="translate(-68.80000305175781, -24)"><rect></rect><foreignObject width="137.60000610351562" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>combined_features<br/>(N, K, out_dim)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-Grouped-59" transform="translate(219.6343765258789, 1295)"><rect class="basic label-container" style="fill:#e0e7ff !important;stroke:#6366f1 !important;stroke-width:2px !important" x="-128.6125030517578" y="-39" width="257.2250061035156" height="78"></rect><g class="label" style="" transform="translate(-98.61250305175781, -24)"><rect></rect><foreignObject width="197.22500610351562" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>combined_grouped<br/>(N, K, Ngrp, out_dim/Ngrp)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-AttnExp-61" transform="translate(839.9562530517578, 1751)"><rect class="basic label-container" style="" x="-116.1187515258789" y="-39" width="232.2375030517578" height="78"></rect><g class="label" style="" transform="translate(-86.1187515258789, -24)"><rect></rect><foreignObject width="172.2375030517578" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>attention_expanded<br/>(N, K, 1, out_dim/Ngrp)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-Multiply-63" transform="translate(291.13750076293945, 1867)"><rect class="basic label-container" style="" x="-100.2249984741211" y="-27" width="200.4499969482422" height="54"></rect><g class="label" style="" transform="translate(-70.2249984741211, -12)"><rect></rect><foreignObject width="140.4499969482422" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>grouped * attention</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-Weighted-67" transform="translate(291.13750076293945, 1983)"><rect class="basic label-container" style="fill:#ddd6fe !important;stroke:#7c3aed !important;stroke-width:2px !important" x="-128.6125030517578" y="-39" width="257.2250061035156" height="78"></rect><g class="label" style="" transform="translate(-98.61250305175781, -24)"><rect></rect><foreignObject width="197.22500610351562" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>weighted_features<br/>(N, K, Ngrp, out_dim/Ngrp)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-Aggregated-69" transform="translate(291.13750076293945, 2135)"><rect class="basic label-container" style="fill:#ddd6fe !important;stroke:#7c3aed !important;stroke-width:2px !important" x="-118.65625" y="-39" width="237.3125" height="78"></rect><g class="label" style="" transform="translate(-88.65625, -24)"><rect></rect><foreignObject width="177.3125" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>aggregated_grouped<br/>(N, Ngrp, out_dim/Ngrp)</p></span></div></foreignObject></g></g><g class="node default  " id="flowchart-OutputFinal-71" transform="translate(291.13750076293945, 2287)"><rect class="basic label-container" style="fill:#dcfce7 !important;stroke:#16a34a !important;stroke-width:3px !important" x="-75.7437515258789" y="-39" width="151.4875030517578" height="78"></rect><g class="label" style="" transform="translate(-45.743751525878906, -24)"><rect></rect><foreignObject width="91.48750305175781" height="48"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel "><p>Output<br/>(N, out_dim)</p></span></div></foreignObject></g></g></g></g></g></svg>